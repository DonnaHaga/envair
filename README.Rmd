
---
output: 
  github_document: 
    toc: TRUE
---


<!-- Edit the README.Rmd only!!! The README.md is generated automatically from README.Rmd. -->

bcgov/envair: BC air quality data retrieval and analysis tool
==========================================================================


```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Overview

bcgov/envair is an R package developed by the BC Ministry of Environment and Climate Change Strategy  Knowledge Management Branch/Environmental and Climate Monitoring Section (ENV/KMB/ECMS) air quality monitoring unit. Package enables R-based retrieval and processing of [air quality monitoring data](https://envistaweb.env.gov.bc.ca/). Output is now compatible with the popular [openair package](https://cran.r-project.org/web/packages/openair/openair.pdf).

# Installation 

You can install `envair` directly from this GitHub repository. To proceed, you will need the [remotes](https://cran.r-project.org/package=remotes) package:

```{r, eval=FALSE}
install.packages("remotes")
```

Next, install and load the `envair` package using `remotes::install_github()`:

```{r, eval=FALSE}
remotes::install_github("bcgov/envair")
library(envair)
```

# Functions

* `importBC_data()` Retrieves station or parameter data from specified year/s between 1980 and yesterday.

    + if station is specified, output includes all parameters from that station. Output is also a compatible input to the openair package functions.

    + if parameter is specified, output displays data from all air quality monitoring stations that reported this data.

* `listBC_stations()` List details of all air quality monitoring stations (active or inactive)

* `importECCC_forecast()` Retrieves AQHI, PM2.5, PM10, O3, and NO2 forecasts from the ECCC datamart

* `GET_VENTING_ECCC()` Retrieve the venting index FLCN39 from Environment and Climate Change Canada datamart

* `GET_VENTING_OBSCR()` Creates a kml or shape file based on the 2019 OBSCR rules. This incorporates venting index and sensitivity zones.



# Usage and Examples


#### `importBC_data()`

****************

##### Using *openair* package function on BC ENV data. 
>By default, this function produces openair-compatible dataframe output. This renames *WSPD_VECT*,*WDIR_VECT* into *ws* and *wd*, changes pollutant names to lower case characters (e.g., *pm25*,*no2*,*so2*).
>To use, specify station name and year/s. 
>For a list of stations, use *listBC_stations()* function. 
>If no year is specified, function retrieves latest data, typically the unverfied data from start of year to current date.

```{r, eval=FALSE}
library(openair)
PG_data <- importBC_data('Prince George Plaza 400',2010:2012)
pollutionRose(PG_data,pollutant='pm25')
```

```{r,echo = FALSE}
knitr::include_graphics('importBC_data.png')
```

##### Importing without column name modification
>To import without renaming column names, specify *use_openairformat = FALSE*. 

```{r, eval =  FALSE}
PG_data <- importBC_data('Prince George Plaza 400',2010:2012,use_openairformat = FALSE)
```

##### Retrieve parameter data
>Specify parameter name to retrieve data. Note that these are very large files and may use up your computer's resources. List of parameters can be found using the *list_parameters()* function. 

```{r,eval=FALSE}
pm25_3year <- importBC_data('PM25',2010:2012)
```

#### `listBC_stations()`

****************

>produces a dataframe that lists all air quality monitoring station details. 
>if year is specified, it retrieves the station details from that year. Note that this entry may not be accurate since system has not been in place to generate these station details.

```{r, eval = FALSE}
stations <- listBC_stations()
```



```{r, echo = FALSE}
table_ <- read.csv('listbc_stations.csv',sep=',')
knitr::kable(table_[1:4,])
```

#### `list_parameters()`

****************

>produce a vector string of available parameters that can be retrieved with *importBC_data()*

